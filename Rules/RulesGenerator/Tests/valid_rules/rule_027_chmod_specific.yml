id: 27
description: "Detect chmod making files world-writable"
action: "BLOCK_EVENT"
events:
    - CHMOD
detection:
    selection_dangerous_mode:
        chmod.requested_mode|gte: 777
    selection_sensitive_file:
        target.file.path|startswith:
            - "/etc/"
            - "/usr/"
    condition: selection_dangerous_mode and selection_sensitive_file


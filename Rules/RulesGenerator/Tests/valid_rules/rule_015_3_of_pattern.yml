# Rule 015: Test "3 of indicator*" pattern syntax
# "3 of indicator*" means at least 3 of the matching selections must be true
id: 15
description: "High confidence detection - at least 3 indicators must match"
action: "BLOCK_KILL_PROCESS"
events:
    - CHMOD
detection:
    indicator_tmp_path:
        process.file.path|contains: "/tmp"
    
    indicator_suspicious_ext:
        process.file.filename|endswith: ".sh"
    
    indicator_network_cmd:
        process.cmd|contains: "curl"
    
    indicator_elevated:
        process.euid: 0
    
    indicator_world_writable:
        chmod.requested_mode|gte: 777
    
    # At least 3 of the 5 indicator_* selections must match
    condition: 3 of indicator*


id: 26
description: "Detect suspicious file renames"
action: "BLOCK_EVENT"
events:
    - RENAME
detection:
    selection_source:
        rename.source_file.path|contains:
            - "/etc/"
            - "/usr/bin/"
    selection_destination:
        rename.destination_file.path|contains:
            - "/tmp/"
            - ".bak"
            - ".old"
    selection_system_file:
        rename.source_file.owner.uid: 0
    condition: selection_source and (selection_destination or selection_system_file)


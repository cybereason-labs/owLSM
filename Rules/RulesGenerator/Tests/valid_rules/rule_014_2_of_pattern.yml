# Rule 014: Test "2 of sel*" pattern syntax
# "2 of sel*" means at least 2 selections starting with "sel" must match
id: 14
description: "Detect suspicious chmod - at least 2 of 3 selection patterns must match"
action: "BLOCK_EVENT"
events:
    - CHMOD
detection:
    sel_path_bin:
        process.file.path|contains: "/bin"
    
    sel_path_usr:
        process.file.path|startswith: "/usr/"
    
    sel_cmd_chmod:
        process.cmd|contains: "chmod"
    
    filter_safe:
        process.euid: 0
    
    # At least 2 of the 3 sel_* selections must match, and filter must NOT match
    condition: 2 of sel* and not filter_safe


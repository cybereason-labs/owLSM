# Rule 010: Test "all of sel*" pattern syntax
# "all of sel*" means all selections starting with "sel" must match (logical AND)
id: 10
description: "Detect chmod with all selection* patterns matching"
action: "BLOCK_EVENT"
events:
    - CHMOD
detection:
    sel_path:
        process.file.path|startswith: "/usr/"
    
    sel_filename:
        process.file.filename: "chmod"
    
    sel_cmd:
        process.cmd|contains: "777"
    
    other_check:
        - process.file.type: "REGULAR_FILE"
        - process.cmd|contains: "/tmp"
    
    # All selections starting with "sel" must match, AND other_check must also match
    condition: all of sel* and other_check


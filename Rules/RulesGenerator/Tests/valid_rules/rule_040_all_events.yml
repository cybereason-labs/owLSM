id: 40
description: "Detect any suspicious activity from untrusted processes"
action: "BLOCK_EVENT"
events:
    - CHMOD
    - CHOWN
    - READ
    - WRITE
    - UNLINK
    - FILE_CREATE
    - EXEC
    - RENAME
detection:
    selection_suspicious_process:
        process.file.path|contains:
            - "/tmp/"
            - "/var/tmp/"
            - "/dev/shm/"
    selection_suspicious_cmd:
        process.cmd|contains:
            - "curl"
            - "wget"
            - "nc"
            - "bash -c"
    selection_parent_shell:
        parent_process.file.filename:
            - "bash"
            - "sh"
            - "zsh"
    condition: selection_suspicious_process or (selection_suspicious_cmd and selection_parent_shell)


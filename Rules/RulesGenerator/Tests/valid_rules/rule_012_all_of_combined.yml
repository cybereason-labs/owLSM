# Rule 012: Test combining "all of" with other conditions
# Complex rule mixing "all of" patterns with regular conditions
id: 12
description: "Complex rule with all of and regular conditions"
action: "BLOCK_KILL_PROCESS"
events:
    - CHMOD
detection:
    target_path:
        process.file.path|contains: "bin"
    
    target_cmd:
        process.cmd|contains: "chmod"
    
    filter_safe:
        process.file.path|startswith: "/usr/bin/"
    
    filter_system:
        process.euid: 0
    
    # All target* selections must match, AND neither filter* selection should match
    condition: all of target* and not (1 of filter*)


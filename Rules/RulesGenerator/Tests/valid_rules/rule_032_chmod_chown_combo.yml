id: 32
description: "Detect permission/ownership changes on executables"
action: "BLOCK_EVENT"
events:
    - CHMOD
    - CHOWN
detection:
    selection_executable_paths:
        target.file.path|startswith:
            - "/usr/bin/"
            - "/usr/local/bin/"
            - "/opt/"
    selection_setuid:
        target.file.suid: 1
    condition: selection_executable_paths or selection_setuid


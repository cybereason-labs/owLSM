id: 25
description: "Detect execution of suspicious processes"
action: "BLOCK_KILL_PROCESS"
events:
    - EXEC
detection:
    selection_target_process:
        target.process.file.path|contains:
            - "/tmp/"
            - "/dev/shm/"
            - "/var/tmp/"
    selection_target_cmd:
        target.process.cmd|contains:
            - "bash -i"
            - "nc -e"
            - "/dev/tcp/"
    selection_privileged:
        target.process.euid: 0
    condition: (selection_target_process or selection_target_cmd) and selection_privileged


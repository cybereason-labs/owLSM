id: 31
description: "Detect read/write to SSH keys"
action: "BLOCK_EVENT"
events:
    - READ
    - WRITE
detection:
    selection_ssh_files:
        target.file.path|contains:
            - ".ssh/authorized_keys"
            - ".ssh/id_rsa"
            - ".ssh/id_ed25519"
    selection_target_type:
        target.file.type: "REGULAR_FILE"
    condition: selection_ssh_files and selection_target_type


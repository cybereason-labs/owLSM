# Rule 009: Test "all of them" syntax
# "all of them" means ALL selections must match (logical AND of all selections)
id: 9
description: "Detect suspicious chmod - all conditions must match (all of them)"
action: "BLOCK_EVENT"
events:
    - CHMOD
detection:
    pathCheck:
        process.file.path|startswith: "/usr/bin"
    
    filenameCheck:
        process.file.filename: "chmod"
    
    cmdCheck:
        process.cmd|contains: "777"
    
    condition: all of them


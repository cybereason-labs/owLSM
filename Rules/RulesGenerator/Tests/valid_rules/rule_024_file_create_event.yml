id: 24
description: "Detect file creation in suspicious locations"
action: "BLOCK_EVENT"
events:
    - FILE_CREATE
detection:
    selection_suspicious_paths:
        target.file.path|startswith:
            - "/tmp/"
            - "/var/tmp/"
            - "/dev/shm/"
    selection_executable:
        target.file.mode|gte: 755
    condition: selection_suspicious_paths and selection_executable


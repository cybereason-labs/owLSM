id: 20
description: "Detect chown on sensitive files"
action: "BLOCK_EVENT"
events:
    - CHOWN
detection:
    selection_sensitive_paths:
        target.file.path|startswith:
            - "/etc/passwd"
            - "/etc/shadow"
            - "/etc/sudoers"
    selection_root_owner:
        target.file.owner.uid: 0
    condition: selection_sensitive_paths or selection_root_owner


id: 21
description: "Detect read access to credential files"
action: "BLOCK_EVENT"
events:
    - READ
detection:
    selection_cred_files:
        target.file.path|contains:
            - "/etc/shadow"
            - ".ssh/id_rsa"
            - ".aws/credentials"
    selection_process:
        process.cmd|contains: "cat"
    condition: selection_cred_files and selection_process


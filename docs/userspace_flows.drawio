<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36" version="29.0.3">
  <diagram name="‫עמוד-1‬" id="VM4qIF5dzmiuyU3m-Tb_">
    <mxGraphModel dx="3080" dy="1912" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-2" target="gi5SMzFpIqlmCfbGAS3l-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-2" value="Commandline parser&lt;br&gt;1) Check at list argc &amp;gt;=&lt;br&gt;2) supported arguments:&amp;nbsp;&lt;br&gt;-c {path to config}&lt;br&gt;-e {pid to exclude}&lt;div&gt;3) add excluded pid&#39;s to excluded_pids_list&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="379.5" y="-50" width="260" height="100" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-4" target="gi5SMzFpIqlmCfbGAS3l-94" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-4" value="Parse config and rules into Config object" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="449.5" y="100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-6" target="gi5SMzFpIqlmCfbGAS3l-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-6" value="Start logger with error_level" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="449.5" y="-170" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.524;entryY=0.038;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-8" target="gi5SMzFpIqlmCfbGAS3l-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-8" value="create id&amp;lt;=&amp;gt;rule_metadata" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="435.25" y="480" width="150.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-10" target="gi5SMzFpIqlmCfbGAS3l-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-10" value="Signal handler" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="449.5" y="-280" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-12" target="gi5SMzFpIqlmCfbGAS3l-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-12" value="Remove rules: &lt;br&gt;outside of version scope&lt;br&gt;disabled features/hooks" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="344.56" y="330" width="329.87" height="90" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-13" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-14" target="gi5SMzFpIqlmCfbGAS3l-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-14" value="Start bpf_open() phase&lt;br&gt;- check if we can return skel as a shared_ptr" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="408" y="690" width="190" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-15" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-16" target="gi5SMzFpIqlmCfbGAS3l-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-16" value="Each hook will have a wrapper class.&lt;br&gt;We will use the template method design patern.&lt;br&gt;(This will allow us to add different types of hooks in the future)&lt;br&gt;each class will have the functions: on_bpf_open(), on_bpf_load(), on_attach(), on_detach(), on_destroy()...&lt;br&gt;For each enabled hook, we will construct its class and add it to the enabled_programs_array." style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="354" y="790" width="300" height="120" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-17" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-18" target="gi5SMzFpIqlmCfbGAS3l-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-18" value="Do global bpf_open work. Like:&lt;br&gt;- setting Kernel_log_level&lt;br&gt;- root pin maps&lt;br&gt;- insert rules" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="419" y="940" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-19" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-20" target="gi5SMzFpIqlmCfbGAS3l-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-20" value="for each(p in enabled_programs_array)&lt;br&gt;{&lt;br&gt;p.on_bpf_open() // currently will only call&amp;nbsp;bpf_program__set_autoattach(skel-&amp;gt;progs.chmod_hook_2, false);&lt;br&gt;}" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="186.5" y="1050" width="635" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-21" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-22" target="gi5SMzFpIqlmCfbGAS3l-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-22" value="Start bpf_load() phase" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="435.5" y="1160" width="135" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-23" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-24" target="gi5SMzFpIqlmCfbGAS3l-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-24" value="Do global bpf_load work. Like:&lt;br&gt;- Adding excluded_pids_list to bpf map&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="372.25" y="1250" width="261.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-26" target="gi5SMzFpIqlmCfbGAS3l-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-26" value="for each(p in enabled_programs_array)&lt;br&gt;{&lt;br&gt;p.on_bpf_load() //currently only ADD_PROG_TO_ARRAY&lt;br&gt;}" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="185.5" y="1360" width="635" height="70" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-27" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-28" target="gi5SMzFpIqlmCfbGAS3l-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-28" value="Start bpf_attach() phase" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="429.5" y="1470" width="147" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-29" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-30" target="gi5SMzFpIqlmCfbGAS3l-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-30" value="ensure system is ready:&lt;br&gt;- no other instances of owLSM running&lt;br&gt;- /sys/fs/bpf available.&lt;br&gt;- remove bpf tables under&amp;nbsp;/sys/fs/bpf/owLSM&lt;br&gt;- other..." style="rounded=0;whiteSpace=wrap;html=1;align=left;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="358" y="564.5" width="290" height="80" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-32" target="gi5SMzFpIqlmCfbGAS3l-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-32" value="Do global bpf_attach work. Like:&lt;br&gt;- start listening to ringbuffs&lt;br&gt;- set ebpf attach time" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="410" y="1570" width="187" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-33" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-34" target="gi5SMzFpIqlmCfbGAS3l-35" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-34" value="for each(p in enabled_programs_array)&lt;br&gt;{&lt;br&gt;p.on_bpf_attach() //Attach each seperetly. print to the stderr any errors. Must start with process related hooks.&amp;nbsp;&lt;br&gt;}" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="186" y="1684" width="635" height="70" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-35" value="conditional_var.wait() until we get a signal" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="443.5" y="1800" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-36" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-37" target="gi5SMzFpIqlmCfbGAS3l-39" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-37" value="Get event_t" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1346.75" y="1800" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-38" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-39" target="gi5SMzFpIqlmCfbGAS3l-41" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-39" value="Convert &lt;br&gt;event_t to C++ object" style="whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1346.75" y="1694" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-40" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-41" target="gi5SMzFpIqlmCfbGAS3l-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-41" value="Start enhancers phase" style="whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1346.75" y="1600" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-42" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-43" target="gi5SMzFpIqlmCfbGAS3l-45" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-43" value="Matched rule enhancer:&lt;br&gt;- Add metadata of rule ID&amp;nbsp;&lt;br&gt;- Maybe in the future, add the async remediation to here. For example, KILL_PARENT" style="whiteSpace=wrap;html=1;rounded=0;align=left;" parent="1" vertex="1">
          <mxGeometry x="1160" y="1490" width="493.5" height="65" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-44" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-45" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1406.75" y="1340" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-45" value="Convert the C++ object&lt;br&gt;to&lt;br&gt;event protobuf" style="whiteSpace=wrap;html=1;align=left;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1327.25" y="1390" width="159" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-46" value="Requested output type" style="rhombus;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1361.25" y="1260" width="91" height="80" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-47" value="Convert the proto&lt;br&gt;to&lt;br&gt;json" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1445.75" y="1180" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-48" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" target="gi5SMzFpIqlmCfbGAS3l-47" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1452.25" y="1300" as="sourcePoint" />
            <mxPoint x="1502.25" y="1250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-49" value="Json" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1452.25" y="1270" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-50" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1505.75" y="1180" as="sourcePoint" />
            <mxPoint x="1505.75" y="1120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-51" value="write to stdout&amp;nbsp;&lt;br&gt;- use IO optimizations" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1445.75" y="1060" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-52" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-46" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1285.75" y="1300" as="sourcePoint" />
            <mxPoint x="1325.75" y="1240" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-53" value="Send protobuf in correct way?" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1265.75" y="1180" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-54" value="Proto" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1295.75" y="1260" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-55" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="940" y="1050" width="660" height="420" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-56" value="Need to understand if this is really neccessry:&lt;br&gt;1) How optimized is:&lt;br&gt;converting C++ to proto and sending/reciving proto&lt;br&gt;vs&lt;br&gt;converting C++ to json and sending/reciving json (with I/O optimization)&lt;br&gt;&lt;br&gt;2) How optimized is:&lt;br&gt;C++ --&amp;gt; proto --&amp;gt; json&lt;br&gt;C++ --&amp;gt; json&lt;br&gt;&lt;br&gt;3) If some objects of the json are empty. &lt;br&gt;Can we emmit them completley?&amp;nbsp;&lt;br&gt;How will it effect the reciver?&lt;br&gt;For example: when the ppid is 1, the process_t.file is always empty.&amp;nbsp;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="952.75" y="1270" width="514" height="110" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-57" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-58" target="gi5SMzFpIqlmCfbGAS3l-60" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-58" value="Get error" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1750" y="1810" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-59" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.869;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-60" target="gi5SMzFpIqlmCfbGAS3l-55" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1810" y="1320" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1810" y="1415" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-60" value="Convert&lt;br&gt;error_t to C++ object" style="whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1750" y="1700" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-61" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-62" target="gi5SMzFpIqlmCfbGAS3l-64" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-62" value="Recive signal:&lt;br&gt;SIGTERM/SIGINT" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1990" y="1810" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-63" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-64" target="gi5SMzFpIqlmCfbGAS3l-66" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-64" value="wakeup main() with conditional_var.notify()" style="whiteSpace=wrap;html=1;rounded=0;align=left;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1907.5" y="1720" width="285" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-65" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-66" target="gi5SMzFpIqlmCfbGAS3l-68" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-66" value="detach all&lt;br&gt;+&lt;br&gt;destroy uprobes" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1990" y="1624" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-67" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-68" target="gi5SMzFpIqlmCfbGAS3l-70" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-68" value="// Do work (maybe logs. Currenly nothing in mind)" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1930" y="1490" width="240" height="90" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-69" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-70" target="gi5SMzFpIqlmCfbGAS3l-72" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-70" value="Set stopper.detached_hooks to true." style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1950" y="1365" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-71" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-72" target="gi5SMzFpIqlmCfbGAS3l-74" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-72" value="stop listening to rinngbuffers and destroy them" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1880" y="1270" width="340" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-73" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-74" target="gi5SMzFpIqlmCfbGAS3l-76" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-74" value="destroy all&amp;nbsp;" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1955" y="1160" width="190" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-75" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-76" target="gi5SMzFpIqlmCfbGAS3l-78" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-76" value="clean /sys/fs/bpf/owlsm" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1990" y="1060" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-77" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-78" target="gi5SMzFpIqlmCfbGAS3l-80" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-78" value="stop logger" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1945" y="940" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-80" value="exit" style="whiteSpace=wrap;html=1;align=left;rounded=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1990" y="830" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-90" value="&lt;div&gt;&lt;b&gt;Objects needed:&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;# Global instance; Holds the config. Maybe including the rules.&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;class Config;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;# abstract class&amp;nbsp;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;class AbstractProbe {&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; virtual bpf_open();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; virtual bpf_load();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; virtual bpf_attach();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; virtual bpf_detach();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; virtual bpf_destroy();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; Type;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;}&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;class LSMProbe : public AbstractProbe {&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_open();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_load();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_attach();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_detach();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_destroy();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; Type = LSM;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;}&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;class FentryProbe : public AbstractProbe {&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_open();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_load();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_attach();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_detach();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_destroy();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; Type = Fentry;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;}&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;# Global instance; Handles the generic work needed before the specific work of each probe.&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;class ProbeManager {&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; vector&amp;lt;AbstractProbe&amp;gt; probes;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_open();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_load();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_attach();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_detach();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; bpf_destroy();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;}&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;# C++ implementation of struct event_t;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;struct Event;&amp;nbsp;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;# C++ implementation of struct error_report_t;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;struct ErrorReport;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;# The thread that reads events from the ringbuffer and does work on them. Maybe we will need one class for Events and one for Errors.&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;class WorkerThread;&lt;/b&gt;&lt;/div&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=light-dark(#330000,#EDEDED);align=left;verticalAlign=middle;rounded=0;fontSize=13;fontColor=#FF9933;" parent="1" vertex="1">
          <mxGeometry x="-870" y="30" width="930" height="840" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-91" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-92" target="gi5SMzFpIqlmCfbGAS3l-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-92" value="Ensure running as root." style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="450.5" y="-400" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-93" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gi5SMzFpIqlmCfbGAS3l-94" target="gi5SMzFpIqlmCfbGAS3l-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gi5SMzFpIqlmCfbGAS3l-94" value="&lt;span style=&quot;text-align: left;&quot;&gt;Set correct usrespace logger level&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="449.5" y="210" width="120" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>

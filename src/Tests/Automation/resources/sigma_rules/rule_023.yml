# Rule 23 - Normal wildcards test
# This rule tests all supported wildcard patterns:
#   - *value* (contains)
#   - value* (startswith)
#   - *value (endswith)
#   - val*ue (internal wildcard - startswith AND endswith)
#
# Match command: touch /tmp/test_wildcards_automation.txt && chmod 755 /tmp/test_wildcards_automation.txt
#
# All four selections must match for the rule to fire, ensuring all wildcard types work correctly.

id: 23
description: "Normal wildcards test - all wildcard patterns"
action: "BLOCK_EVENT"
events:
    - CHMOD
detection:
    contains_pattern:
        process.cmd: '*wildcards*'
    
    startswith_pattern:
        target.file.path: '/tmp/test_*'
    
    endswith_pattern:
        process.file.filename: '*mod'
    
    internal_wildcard:
        target.file.path: '/tmp/*automation.txt'

    condition: contains_pattern and startswith_pattern and endswith_pattern and internal_wildcard


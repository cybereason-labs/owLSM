# Rule 21 - Second rule in ordering test (BLOCK_EVENT)
# Tests "first match wins" behavior - this rule comes after rule 20
#
# When /tmp/ordering_check is used: Rule 20 matches first → this rule is never evaluated
# When /tmp/ordering_check_skip_first is used: Rule 20 doesn't match → this rule matches

id: 21
description: "Rule ordering test - second rule with BLOCK_EVENT"
action: "BLOCK_EVENT"
events:
    - CHMOD
detection:
    match_chmod:
        process.file.path|endswith: "chmod"
        target.file.path|contains: "ordering_check"
        chmod.requested_mode: 448

    condition: match_chmod


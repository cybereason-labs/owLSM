# Test rule 8 - EXEC block event

id: 8
description: "Test rule 8 - EXEC block with process, parent_process, and new_process conditions"
action: "BLOCK_EVENT"
events:
    - EXEC
detection:
    selection_process:
        process.file.path|contains: "bin/python"
        process.cmd|contains: "pytest"
    selection_parent_process:
        parent_process.ptrace_flags: 0
        parent_process.suid: 0
        parent_process.file.path|contains: "bin"
        parent_process.cmd|contains: "python"
    selection_target:
        target.process.file.path|contains: "ls"
        target.process.cmd|endswith: "ls -lAa /tmp"
    condition: selection_process and selection_parent_process and selection_target


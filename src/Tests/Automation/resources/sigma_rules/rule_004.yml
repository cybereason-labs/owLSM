# Test rule 4 - CHMOD block event

id: 4
description: "Test rule 4 - CHMOD block with process euid below threshold"
action: "BLOCK_EVENT"
min_version: "0.0.1"
max_version: "1000.0.22"
events:
    - CHMOD
detection:
    selection_process:
        process.pid|gt: 100
        process.euid|lt: 5000
        process.file.path|endswith: "bin/chmod"
        process.cmd|contains: "666"
    selection_target:
        target.file.path|endswith: "test2"
    selection_chmod:
        chmod.requested_mode: 438
    condition: selection_process and selection_target and selection_chmod


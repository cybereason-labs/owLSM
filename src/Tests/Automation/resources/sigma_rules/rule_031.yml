# Test rule 31 - RMDIR exclude event

id: 31
description: "Test rule 31 - RMDIR exclude event for test directories"
action: "EXCLUDE_EVENT"
events:
    - RMDIR
detection:
    selection_process:
        process.file.path|contains: "bin/python"
        process.cmd|contains: "pytest"
    selection_target:
        target.file.path|contains: "/tmp/test_exclude_rmdir_event"
    condition: selection_process and selection_target

# Fieldref automation test - RENAME with 2 string and 2 numeric fieldrefs
# Uses only source_file and destination_file fields.
#
# String fieldrefs (endswith - NOT exactmatch, path is longer than filename):
#   1. rename.source_file.path endswith rename.source_file.filename
#      ("/tmp/fieldref_rename_src" ends with "fieldref_rename_src")
#   2. rename.destination_file.path endswith rename.destination_file.filename
#      ("/tmp/fieldref_rename_dst" ends with "fieldref_rename_dst")
#
# Numeric fieldrefs (lt/lte - each match is strictly due to less-than, not equality):
#   1. rename.source_file.mode lt rename.destination_file.mode   (420 < 493, strictly less)
#   2. rename.destination_file.owner.uid lte rename.source_file.mode (0 < 420, lte due to lt not equality)

id: 38
description: "Fieldref automation test - RENAME with 2 string and 2 numeric fieldrefs using source/destination fields"
action: "BLOCK_EVENT"
events:
    - RENAME
detection:
    string_sel:
        rename.source_file.path|endswith|fieldref: rename.source_file.filename
        rename.destination_file.path|endswith|fieldref: rename.destination_file.filename
    numeric_sel:
        rename.source_file.mode|lt|fieldref: rename.destination_file.mode
        rename.destination_file.owner.uid|lte|fieldref: rename.source_file.mode
    source_file:
        rename.source_file.path: /tmp/fieldref_rename_src
    condition: string_sel and numeric_sel and source_file

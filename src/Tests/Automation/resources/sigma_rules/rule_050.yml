# Placeholder expansion test: block file operations when ALL three
# placeholder-expanded conditions match (process name, process path, target path).
# Covers CHMOD, CHOWN, WRITE, and READ events.

id: 50
description: "Block file ops matching all three placeholder conditions"
action: "BLOCK_EVENT"
events: [CHMOD, CHOWN, WRITE, READ]
detection:
    sel_process_name:
        process.file.filename|expand: "%test_process_names%"
    sel_process_path:
        process.file.path|contains|expand: "%test_path_keywords%"
    sel_target:
        target.file.path|contains|expand: "%test_target_paths%"
    condition: sel_process_name and sel_process_path and sel_target

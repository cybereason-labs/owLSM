# Rule 22 - Escaped wildcards test
# This rule tests that escaped wildcard characters (\* and \?) are treated as literal characters.
#
# Match command: touch '/tmp/escaped*wildcards?test' && chmod 755 '/tmp/escaped*wildcards?test'
# The filename contains literal asterisk (*) and question mark (?) characters.
#
# This rule should match files with the exact filename "escaped*wildcards?test" in /tmp/
# The \* and \? in the rule are escaped and match literal * and ? characters.

id: 22
description: "Escaped wildcards test - matches literal * and ? in filename"
action: "BLOCK_EVENT"
events:
    - CHMOD
detection:
    target_file:
        target.file.path: '/tmp/escaped\*wildcards\?test'

    condition: target_file


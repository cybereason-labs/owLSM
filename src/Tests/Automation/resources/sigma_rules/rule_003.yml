# Test rule 3 - CHMOD block event with extensive process conditions

id: 3
description: "Test rule 3 - CHMOD block with extensive process fields and exact match path"
action: "BLOCK_EVENT"
events:
    - CHMOD
detection:
    selection_process:
        process.pid: 1234
        process.ppid|lt: 500
        process.ruid|gt: 2000
        process.rgid|gte: 2000
        process.suid: 0
        process.ptrace_flags: 0
        process.cmd|startswith: "appd"
        process.file.path|contains: "/home/app/data"
    selection_target:
        target.file.path: "/home/app/data/config.yaml"
        target.file.mode|gt: 600
    selection_chmod:
        chmod.requested_mode|lt: 400
    condition: selection_process and selection_target and selection_chmod

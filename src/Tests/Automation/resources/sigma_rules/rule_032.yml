# Test rule 32 - WRITE block based on shell_command and target file

id: 32
description: "Test rule 32 - WRITE block when shell_command contains marker and target file matches"
action: "BLOCK_EVENT"
events:
    - WRITE
detection:
    selection_shell_command:
        - process.shell_command|contains: "> /tmp/shell_command_blocking"
        - parent_process.shell_command|contains: "> /tmp/shell_command_blocking"
    selection_target:
        target.file.path: "/tmp/shell_command_blocking.txt"
    condition: selection_shell_command and selection_target

# Test rule 5 - CHMOD block kill process

id: 5
description: "Test rule 5 - CHMOD block kill process with rgid and parent_process conditions"
action: "BLOCK_KILL_PROCESS"
min_version: "0.0.2"
events:
    - CHMOD
detection:
    selection_process:
        process.rgid|lte: 5000
        process.file.path|contains: "chmod"
        process.cmd|endswith: "555 /tmp/test3"
    selection_parent_process:
        parent_process.ptrace_flags: 0
        parent_process.suid: 0
        parent_process.file.path|contains: "python"
        parent_process.cmd|contains: "python"
    selection_target:
        target.file.path|endswith: "test3"
    selection_chmod:
        chmod.requested_mode: 365
    condition: selection_process and selection_parent_process and selection_target and selection_chmod


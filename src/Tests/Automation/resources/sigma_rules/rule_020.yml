# Rule 20 - First rule in ordering test (EXCLUDE_EVENT)
# Tests "first match wins" behavior - this rule comes before rule 21
#
# Trigger rule 20 (EXCLUDE_EVENT): /usr/bin/chmod 700 /tmp/ordering_check
#   - Both rules would match, but rule 20 is first → event excluded
#
# Trigger rule 21 only (BLOCK_EVENT): /usr/bin/chmod 700 /tmp/ordering_check_skip_first
#   - Rule 20 doesn't match (due to "not"), rule 21 matches → event blocked

id: 20
description: "Rule ordering test - first rule with EXCLUDE_EVENT"
action: "EXCLUDE_EVENT"
events:
    - CHMOD
detection:
    match_chmod:
        process.file.path|endswith: "chmod"
        target.file.path|contains: "ordering_check"
        chmod.requested_mode: 448

    filter_skip:
        - target.file.path|contains: "skip_first"

    condition: match_chmod and not filter_skip


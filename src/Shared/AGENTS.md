# AGENTS.md - Shared

## Overview

The Shared directory contains header files and script that are used by more then 1 component.

---

## Contents

```
Shared/
├── AGENTS.md                # This file
├── constants.h              # Auto-generated constants (DO NOT EDIT MANUALLY). generated by generate_constants.py
├── constants.json           # Source of truth for constants. both Userspace, EBPF, and RulesGenerator rely on this.
├── generate_constants.py    # Script to generate constants.h from constants.json
├── bpf_header_includes.h    # Common BPF header includes.
├── events_structs.h         # Event data structures (shared between kernel/userspace)
├── rules_structs.h          # Rule data structures
├── rodata_maps_related_structs.h  # Read-only data map structures
└── log_levels_enum.h        # Logging level definitions
```


## Important Files

### `constants.h` (Auto-generated)

**DO NOT EDIT MANUALLY** - Generated from `constants.json` by `generate_constants.py`.

Contains:
- Macro definitions (`MAX_TOKENS_PER_RULE`, `MAX_NEEDLE_LENGTH`, etc.)
- Enum definitions (`operator_types`, `rule_action`, `comparison_type`, `rule_field_type`)

To regenerate:
```bash
make -C src/Kernel generate_constants
# or
python3 src/Shared/generate_constants.py
```

### `constants.json` (Source of Truth)

Edit this file to add/modify constants, then regenerate `constants.h`.

---

## Critical Synchronization Points

Changes to Shared files require rebuilding **both** Kernel and Userspace:

```bash
make -j$(nproc)  # Rebuilds everything
```

Additionally, `Rules/RulesGenerator/constants.py` must stay in sync with `constants.h` manually. Ensure enum values and constants match.

